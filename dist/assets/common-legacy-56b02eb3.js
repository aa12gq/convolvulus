/*! 
 Build based on gin-vue-admin 
 Time : 1705391497000 */
!function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,(i=r.key,o=void 0,"symbol"==typeof(o=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(i,"string"))?o:String(o)),r)}var i,o}System.register(["./index-legacy-65d10e67.js","./_plugin-vue_export-helper-legacy-61c4c9d1.js"],(function(t,n){"use strict";var r,i,o;return{setters:[function(e){r=e.s,i=e.u},function(e){o=e._}],execute:function(){var n=document.createElement("style");n.textContent=".image-uploader[data-v-25e77e3f]{border:1px dashed #d9d9d9;width:180px;border-radius:6px;cursor:pointer;position:relative;overflow:hidden;border-color:#409eff}.image-uploader-icon[data-v-25e77e3f]{font-size:28px;color:#8c939d;width:178px;height:178px;line-height:178px;text-align:center}.image[data-v-25e77e3f]{width:178px;height:178px;display:block}\n",document.head.appendChild(n);t("g",(function(e){return r({url:"/fileUploadAndDownload/getFileList",method:"post",data:e})})),t("d",(function(e){return r({url:"/fileUploadAndDownload/deleteFile",method:"post",data:e})})),t("e",(function(e){return r({url:"/fileUploadAndDownload/editFileName",method:"post",data:e})}));var a=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1920;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.file=e,this.fileSize=n,this.maxWH=r}var n,r,i;return n=t,(r=[{key:"compress",value:function(){var e=this,t=this.file.type;return this.file.size,new Promise((function(n){var r=new FileReader;r.readAsDataURL(e.file),r.onload=function(){var i=document.createElement("canvas"),o=document.createElement("img");o.src=r.result,o.onload=function(){var r=i.getContext("2d"),a=e.dWH(o.width,o.height,e.maxWH);i.width=a.width,i.height=a.height,r.clearRect(0,0,i.width,i.height),r.drawImage(o,0,0,i.width,i.height);var l=i.toDataURL(t,.9);e.fileSizeKB(l),e.fileSize;var u=e.dataURLtoBlob(l,t),d=new File([u],e.file.name);n(d)}}}))}},{key:"dWH",value:function(e,t,n){var r={width:e,height:t};return Math.max(e,t)>n?e>t?(r.width=n,r.height=Math.round(t*(n/e)),r):(r.height=n,r.width=Math.round(e*(n/t)),r):r}},{key:"fileSizeKB",value:function(e){return Math.round(3*e.split(",")[1].length/4/1024)}},{key:"dataURLtoBlob",value:function(e,t){for(var n=atob(e.split(",")[1]),r=e.split(",")[0].split(":")[1].split(";")[0],i=new ArrayBuffer(n.length),o=new Uint8Array(i),a=0;a<n.length;a++)o[a]=n.charCodeAt(a);return t&&(r=t),new Blob([i],{type:r,lastModifiedDate:new Date})}}])&&e(n.prototype,r),i&&e(n,i),Object.defineProperty(n,"prototype",{writable:!1}),t}(),l=(t("a",(function(e){return e&&"http"!==e.slice(0,4)?"/api/"+e:e})),t("i",(function(e){return e.endsWith(".mp4")||e.endsWith(".mov")||e.endsWith(".webm")||e.endsWith(".ogg")})),Object.assign({name:"UploadImage"},{__name:"image",props:{imageUrl:{type:String,default:""},fileSize:{type:Number,default:2048},maxWH:{type:Number,default:1920}},emits:["on-success"],setup:function(e,t){var n=t.emit,r=e,o=Vue.ref("/api"),l=i(),u=function(e){var t="image/jpeg"===e.type,n="image/png"===e.type;if(!t&&!n)return ElementPlus.ElMessage.error("上传头像图片只能是 jpg或png 格式!"),!1;var i=e.size/1024<r.fileSize;return i||new a(e,r.fileSize,r.maxWH).compress()},d=function(e){var t=e.data;t.file&&n("on-success",t.file.url)};return function(e,t){var n=Vue.resolveComponent("el-button"),r=Vue.resolveComponent("el-upload");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(r,{action:"".concat(o.value,"/fileUploadAndDownload/upload"),headers:{"x-token":Vue.unref(l).token},"show-file-list":!1,"on-success":d,"before-upload":u,multiple:!1},{default:Vue.withCtx((function(){return[Vue.createVNode(n,{type:"primary"},{default:Vue.withCtx((function(){return[Vue.createTextVNode("压缩上传")]})),_:1})]})),_:1},8,["action","headers"])])}}}));t("U",o(l,[["__scopeId","data-v-25e77e3f"]])),t("_",Object.assign({name:"UploadCommon"},{__name:"common",emits:["on-success"],setup:function(e,t){var n=t.emit,r=Vue.ref("/api"),o=i(),a=Vue.ref(!1),l=function(e){a.value=!0;var t,n=e.size/1024/1024<.5,r=e.size/1024/1024<5,i="video/mp4"==(t=e.type)||"video/webm"==t||"video/ogg"==t,o=function(e){return"image/jpeg"==e||"image/png"==e||"image/webp"==e||"image/svg+xml"==e}(e.type),l=!0;return i||o||(ElementPlus.ElMessage.error("上传图片只能是 jpg,png,svg,webp 格式, 上传视频只能是 mp4,webm 格式!"),a.value=!1,l=!1),!r&&i&&(ElementPlus.ElMessage.error("上传视频大小不能超过 5MB"),a.value=!1,l=!1),!n&&o&&(ElementPlus.ElMessage.error("未压缩的上传图片大小不能超过 500KB，请使用压缩上传"),a.value=!1,l=!1),l},u=function(e){var t=e.data;t.file&&n("on-success",t.file.url)},d=function(){ElementPlus.ElMessage({type:"error",message:"上传失败"}),a.value=!1};return function(e,t){var n=Vue.resolveComponent("el-button"),i=Vue.resolveComponent("el-upload");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(i,{action:"".concat(r.value,"/fileUploadAndDownload/upload"),"before-upload":l,headers:{"x-token":Vue.unref(o).token},"on-error":d,"on-success":u,"show-file-list":!1,class:"upload-btn"},{default:Vue.withCtx((function(){return[Vue.createVNode(n,{type:"primary"},{default:Vue.withCtx((function(){return[Vue.createTextVNode("普通上传")]})),_:1})]})),_:1},8,["action","headers"])])}}}))}}}))}();
